<!-- Dev Journal Entry - Improved with expandable sections and photo galleries -->
<div class="journal-entry" 
     x-data="{ 
         expanded: {{ .Get "expanded" | default "false" }},
         activePhoto: 0,
         photoModal: false
     }">
    
    <!-- Timeline Marker -->
    <div class="timeline-marker">
        <div class="marker-dot {{ if .Get "success" }}success{{ end }}"></div>
        <div class="marker-line"></div>
    </div>
    
    <!-- Entry Content -->
    <div class="timeline-content">
        
        <!-- Entry Header (Always Visible) -->
        <div class="entry-header" @click="expanded = !expanded">
            <div class="entry-header-content">
                <span class="entry-date">{{ .Get "date" }}</span>
                <h3 class="entry-title">{{ .Get "title" }}</h3>
                
                {{ if .Get "subtitle" }}
                <p class="entry-subtitle">{{ .Get "subtitle" }}</p>
                {{ end }}
                
                <!-- Quick Stats Preview -->
                {{ if .Get "hours" }}
                <div class="quick-stats">
                    {{ if .Get "hours" }}
                    <span class="quick-stat">‚è±Ô∏è {{ .Get "hours" }}h</span>
                    {{ end }}
                    {{ if .Get "iterations" }}
                    <span class="quick-stat">üîÑ {{ .Get "iterations" }} iterac√≠</span>
                    {{ end }}
                    {{ if .Get "fails" }}
                    <span class="quick-stat">‚ùå {{ .Get "fails" }} selh√°n√≠</span>
                    {{ end }}
                </div>
                {{ end }}
            </div>
            
            <!-- Expand Button -->
            <button class="expand-btn" :class="{ 'expanded': expanded }">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>
        </div>
        
        <!-- Expandable Body -->
        <div class="entry-body" x-show="expanded" 
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 max-h-0"
             x-transition:enter-end="opacity-100 max-h-screen"
             x-collapse>
            
            <!-- Photo Gallery (if photos provided) -->
            {{ if .Get "photos" }}
            <div class="photo-gallery">
                <div class="gallery-grid">
                    {{ $photos := split (.Get "photos") "," }}
                    {{ $captions := split (.Get "photo_captions" | default "") "|" }}
                    {{ range $index, $photo := $photos }}
                    <div class="gallery-item" @click="activePhoto = {{ $index }}; photoModal = true">
                        <img src="{{ trim $photo " " | absURL }}" alt="Photo {{ add $index 1 }}">
                        {{ if index $captions $index }}
                        <div class="gallery-caption">{{ index $captions $index }}</div>
                        {{ end }}
                    </div>
                    {{ end }}
                </div>
            </div>
            {{ end }}
            
            <!-- Main Text Content -->
            <div class="entry-text">
                {{ .Inner | markdownify }}
            </div>
            
            <!-- Problem Box (if specified) -->
            {{ if .Get "problem" }}
            <div class="problem-box">
                <h4>ü§î Probl√©m</h4>
                <p>{{ .Get "problem" | markdownify }}</p>
            </div>
            {{ end }}
            
            <!-- Solution Box (if specified) -->
            {{ if .Get "solution" }}
            <div class="solution-box">
                <h4>üí° ≈òe≈°en√≠</h4>
                <p>{{ .Get "solution" | markdownify }}</p>
            </div>
            {{ end }}
            
            <!-- Technical Details (if specified) -->
            {{ if .Get "tech_details" }}
            <div class="tech-details">
                <h4>‚öôÔ∏è Technick√© detaily</h4>
                <div class="tech-content">
                    {{ .Get "tech_details" | markdownify }}
                </div>
            </div>
            {{ end }}
            
            <!-- Stats Row (if specified) -->
            {{ if or (.Get "stat1_label") (.Get "stat2_label") }}
            <div class="stats-row">
                {{ if .Get "stat1_label" }}
                <div class="stat-item">
                    <span class="stat-label">{{ .Get "stat1_label" }}</span>
                    <span class="stat-value">{{ .Get "stat1_value" }}</span>
                </div>
                {{ end }}
                {{ if .Get "stat2_label" }}
                <div class="stat-item">
                    <span class="stat-label">{{ .Get "stat2_label" }}</span>
                    <span class="stat-value">{{ .Get "stat2_value" }}</span>
                </div>
                {{ end }}
                {{ if .Get "stat3_label" }}
                <div class="stat-item">
                    <span class="stat-label">{{ .Get "stat3_label" }}</span>
                    <span class="stat-value">{{ .Get "stat3_value" }}</span>
                </div>
                {{ end }}
                {{ if .Get "stat4_label" }}
                <div class="stat-item">
                    <span class="stat-label">{{ .Get "stat4_label" }}</span>
                    <span class="stat-value">{{ .Get "stat4_value" }}</span>
                </div>
                {{ end }}
            </div>
            {{ end }}
            
            <!-- Lesson Learned (if specified) -->
            {{ if .Get "lesson" }}
            <div class="lesson-learned">
                <strong>Pouƒçen√≠:</strong> {{ .Get "lesson" | markdownify }}
            </div>
            {{ end }}
            
        </div>
    </div>
    
    <!-- Photo Modal (Full Screen Gallery) -->
    {{ if .Get "photos" }}
    <div x-show="photoModal" 
         class="photo-modal"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         @click.self="photoModal = false"
         style="display: none;">
        
        <button @click="photoModal = false" class="modal-close">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
        
        <div class="modal-content">
            {{ $photos := split (.Get "photos") "," }}
            {{ $captions := split (.Get "photo_captions" | default "") "|" }}
            
            <template x-for="(photo, index) in {{ len $photos }}" :key="index">
                <div x-show="activePhoto === index" class="modal-slide">
                    <img :src="[{{ range $index, $photo := $photos }}{{ if $index }},{{ end }}'{{ trim $photo " " | absURL }}'{{ end }}][index]" alt="">
                    {{ if gt (len $captions) 0 }}
                    <div class="modal-caption" x-text="[{{ range $index, $caption := $captions }}{{ if $index }},{{ end }}'{{ . }}'{{ end }}][index] || ''"></div>
                    {{ end }}
                </div>
            </template>
            
            {{ if gt (len $photos) 1 }}
            <button @click="activePhoto = (activePhoto - 1 + {{ len $photos }}) % {{ len $photos }}" class="modal-nav prev">‚Äπ</button>
            <button @click="activePhoto = (activePhoto + 1) % {{ len $photos }}" class="modal-nav next">‚Ä∫</button>
            {{ end }}
        </div>
    </div>
    {{ end }}
    
</div>

<style>
/* Journal Entry Container */
.journal-entry {
    display: grid;
    grid-template-columns: 60px 1fr;
    gap: 40px;
    margin-bottom: 60px;
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.6s ease-out forwards;
}

@keyframes fadeInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Timeline Marker */
.timeline-marker {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.marker-dot {
    width: 24px;
    height: 24px;
    background: #FF425C;
    border-radius: 50%;
    border: 4px solid #191E22;
    box-shadow: 0 0 0 4px rgba(255, 66, 92, 0.2);
    position: relative;
    z-index: 2;
}

.marker-dot.success {
    background: #22c55e;
    box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2);
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2); }
    50% { box-shadow: 0 0 0 8px rgba(34, 197, 94, 0.4); }
}

.marker-line {
    width: 2px;
    flex: 1;
    background: linear-gradient(180deg, #FF425C 0%, transparent 100%);
    margin-top: 8px;
    min-height: 100px;
}

/* Timeline Content */
.timeline-content {
    background: #2A2A2A;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    overflow: hidden;
    transition: all 0.3s ease;
}

.timeline-content:hover {
    border-color: rgba(255, 66, 92, 0.3);
}

/* Entry Header (Clickable) */
.entry-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 30px 40px;
    cursor: pointer;
    transition: background 0.2s ease;
}

.entry-header:hover {
    background: rgba(255, 255, 255, 0.02);
}

.entry-header-content {
    flex: 1;
}

.entry-date {
    display: inline-block;
    background: rgba(255, 66, 92, 0.1);
    color: #FF425C;
    padding: 6px 16px;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: bold;
    margin-bottom: 12px;
}

.entry-title {
    font-size: 2rem;
    font-weight: 900;
    color: white;
    margin: 0 0 8px 0;
    line-height: 1.2;
}

.entry-subtitle {
    color: #999;
    font-size: 1.1rem;
    margin: 0;
    font-weight: 300;
}

.quick-stats {
    display: flex;
    gap: 15px;
    margin-top: 15px;
    flex-wrap: wrap;
}

.quick-stat {
    background: #1a1a1a;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 0.85rem;
    color: #ccc;
}

/* Expand Button */
.expand-btn {
    background: rgba(255, 66, 92, 0.1);
    border: 1px solid rgba(255, 66, 92, 0.3);
    color: #FF425C;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.expand-btn:hover {
    background: rgba(255, 66, 92, 0.2);
    transform: scale(1.1);
}

.expand-btn svg {
    transition: transform 0.3s ease;
}

.expand-btn.expanded svg {
    transform: rotate(180deg);
}

/* Entry Body (Expandable) */
.entry-body {
    padding: 0 40px 40px 40px;
    overflow: hidden;
}

/* Photo Gallery */
.photo-gallery {
    margin-bottom: 30px;
}

.gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 15px;
}

.gallery-item {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    aspect-ratio: 4/3;
    background: #1a1a1a;
    transition: transform 0.3s ease;
}

.gallery-item:hover {
    transform: scale(1.05);
}

.gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.gallery-caption {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
    color: white;
    padding: 15px;
    font-size: 0.9rem;
}

/* Entry Text */
.entry-text {
    color: #ccc;
    font-size: 1.05rem;
    line-height: 1.8;
    margin-bottom: 25px;
}

.entry-text p {
    margin-bottom: 15px;
}

.entry-text strong {
    color: white;
}

.entry-text ul, .entry-text ol {
    margin: 15px 0;
    padding-left: 25px;
}

.entry-text li {
    margin-bottom: 8px;
}

/* Problem/Solution Boxes */
.problem-box,
.solution-box,
.tech-details {
    background: #1a1a1a;
    border-left: 4px solid #FF425C;
    padding: 25px;
    border-radius: 12px;
    margin: 25px 0;
}

.solution-box {
    border-left-color: #22c55e;
}

.tech-details {
    border-left-color: #3b82f6;
}

.problem-box h4,
.solution-box h4,
.tech-details h4 {
    color: white;
    margin: 0 0 15px 0;
    font-size: 1.2rem;
}

/* Stats Row */
.stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 25px 0;
}

.stat-item {
    background: #1a1a1a;
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
}

.stat-label {
    display: block;
    color: #999;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 8px;
}

.stat-value {
    display: block;
    color: #FF425C;
    font-size: 1.8rem;
    font-weight: bold;
}

/* Lesson Learned */
.lesson-learned {
    background: rgba(255, 66, 92, 0.05);
    border: 1px solid rgba(255, 66, 92, 0.2);
    padding: 20px;
    border-radius: 12px;
    margin-top: 25px;
    color: #ccc;
    font-size: 1.05rem;
    line-height: 1.6;
}

.lesson-learned strong {
    color: #FF425C;
}

/* Photo Modal */
.photo-modal {
    position: fixed;
    inset: 0;
    background: transparent;
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    z-index: 99999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
    border-radius: 0;
}

.modal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 10;
}

.modal-close:hover {
    background: rgba(255, 66, 92, 0.9);
    border-color: rgba(255, 66, 92, 1);
    transform: scale(1.1) rotate(90deg);
    box-shadow: 0 0 20px rgba(255, 66, 92, 0.5);
}

.modal-close svg {
    width: 20px;
    height: 20px;
    stroke-width: 2.5;
}

.modal-content {
    position: relative;
    max-width: 95vw;
    max-height: 95vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-slide {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
    max-width: 100%;
}

.modal-slide img {
    max-width: 90vw;
    max-height: 85vh;
    object-fit: contain;
    border-radius: 24px;
    box-shadow: 0 30px 90px rgba(0, 0, 0, 0.7);
}

.modal-caption {
    color: rgba(255, 255, 255, 1);
    font-size: 1.1rem;
    text-align: center;
    max-width: 700px;
    padding: 16px 32px;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(20px);
    border-radius: 24px;
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
}

.modal-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    color: white;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    font-size: 2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-nav:hover {
    background: rgba(255, 66, 92, 0.9);
    border-color: rgba(255, 66, 92, 1);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 0 20px rgba(255, 66, 92, 0.5);
}

.modal-nav.prev {
    left: 20px;
}

.modal-nav.next {
    right: 20px;
}

/* Responsive */
@media (max-width: 768px) {
    .journal-entry {
        grid-template-columns: 40px 1fr;
        gap: 20px;
    }
    
    .entry-header {
        padding: 20px;
    }
    
    .entry-body {
        padding: 0 20px 20px 20px;
    }
    
    .entry-title {
        font-size: 1.5rem;
    }
    
    .gallery-grid {
        grid-template-columns: 1fr;
    }
    
    .modal-nav {
        width: 50px;
        height: 50px;
        font-size: 2rem;
    }
}
</style>